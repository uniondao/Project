!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t=t||self).Erebos=t.Erebos||{},t.Erebos.swarm={}))}(this,function(t){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var f=e(function(t){var e=function(o){var c,t=Object.prototype,a=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function s(t,e,r,n){var i=e&&e.prototype instanceof u?e:u,o=Object.create(i.prototype),s=new R(n||[]);return o._invoke=function(o,s,u){var c=h;return function(t,e){if(c===l)throw new Error("Generator is already running");if(c===d){if("throw"===t)throw e;return O()}for(u.method=t,u.arg=e;;){var r=u.delegate;if(r){var n=S(r,u);if(n){if(n===y)continue;return n}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===h)throw c=d,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=l;var i=f(o,s,u);if("normal"===i.type){if(c=u.done?d:p,i.arg===y)continue;return{value:i.arg,done:u.done}}"throw"===i.type&&(c=d,u.method="throw",u.arg=i.arg)}}}(t,r,s),o}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}o.wrap=s;var h="suspendedStart",p="suspendedYield",l="executing",d="completed",y={};function u(){}function v(){}function b(){}var w={};w[i]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==t&&a.call(m,i)&&(w=m);var _=b.prototype=u.prototype=Object.create(w);function E(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function x(c){var e;this._invoke=function(r,n){function t(){return new Promise(function(t,e){!function e(t,r,n,i){var o=f(c[t],c,r);if("throw"!==o.type){var s=o.arg,u=s.value;return u&&"object"==typeof u&&a.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,n,i)},function(t){e("throw",t,n,i)}):Promise.resolve(u).then(function(t){s.value=t,n(s)},function(t){return e("throw",t,n,i)})}i(o.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function S(t,e){var r=t.iterator[e.method];if(r===c){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=c,S(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var n=f(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,y;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=c),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=c,t.done=!0,t};return n.next=n}}return{next:O}}function O(){return{value:c,done:!0}}return v.prototype=_.constructor=b,b.constructor=v,b[n]=v.displayName="GeneratorFunction",o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,n in t||(t[n]="GeneratorFunction")),t.prototype=Object.create(_),t},o.awrap=function(t){return{__await:t}},E(x.prototype),x.prototype[r]=function(){return this},o.AsyncIterator=x,o.async=function(t,e,r,n){var i=new x(s(t,e,r,n));return o.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(_),_[n]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},o.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=I,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return o.type="throw",o.arg=r,n.next=t,e&&(n.method="next",n.arg=c),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:I(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=c),y}},o}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}});function c(t,e,r,n,i,o,s){try{var u=t[o](s),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,i)}function a(u){return function(){var t=this,s=arguments;return new Promise(function(e,r){var n=u.apply(t,s);function i(t){c(n,e,r,i,o,"next",t)}function o(t){c(n,e,r,i,o,"throw",t)}i(void 0)})}}function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function p(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],0<=e.indexOf(r)||(i[r]=t[r]);return i}var r="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},l=[],d=[],y="undefined"!=typeof Uint8Array?Uint8Array:Array,v=!1;function b(){v=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)l[e]=t[e],d[t.charCodeAt(e)]=e;d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63}function w(t,e,r){for(var n,i,o=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push(l[(i=n)>>18&63]+l[i>>12&63]+l[i>>6&63]+l[63&i]);return o.join("")}function g(t){var e;v||b();for(var r=t.length,n=r%3,i="",o=[],s=0,u=r-n;s<u;s+=16383)o.push(w(t,s,u<s+16383?u:s+16383));return 1==n?(e=t[r-1],i+=l[e>>2],i+=l[e<<4&63],i+="=="):2==n&&(e=(t[r-2]<<8)+t[r-1],i+=l[e>>10],i+=l[e>>4&63],i+=l[e<<2&63],i+="="),o.push(i),o.join("")}function m(t,e,r,n,i){var o,s,u=8*i-n-1,c=(1<<u)-1,a=c>>1,f=-7,h=r?i-1:0,p=r?-1:1,l=t[e+h];for(h+=p,o=l&(1<<-f)-1,l>>=-f,f+=u;0<f;o=256*o+t[e+h],h+=p,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;0<f;s=256*s+t[e+h],h+=p,f-=8);if(0===o)o=1-a;else{if(o===c)return s?NaN:1/0*(l?-1:1);s+=Math.pow(2,n),o-=a}return(l?-1:1)*s*Math.pow(2,o-n)}function _(t,e,r,n,i,o){var s,u,c,a=8*o-i-1,f=(1<<a)-1,h=f>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),2<=(e+=1<=s+h?p/c:p*Math.pow(2,1-h))*c&&(s++,c/=2),f<=s+h?(u=0,s=f):1<=s+h?(u=(e*c-1)*Math.pow(2,i),s+=h):(u=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));8<=i;t[r+l]=255&u,l+=d,u/=256,i-=8);for(s=s<<i|u,a+=i;0<a;t[r+l]=255&s,l+=d,s/=256,a-=8);t[r+l-d]|=128*y}var E={}.toString,x=Array.isArray||function(t){return"[object Array]"==E.call(t)};function S(){return A.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function T(t,e){if(S()<e)throw new RangeError("Invalid typed array length");return A.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=A.prototype:(null===t&&(t=new A(e)),t.length=e),t}function A(t,e,r){if(!(A.TYPED_ARRAY_SUPPORT||this instanceof A))return new A(t,e,r);if("number"!=typeof t)return R(this,t,e,r);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return O(this,t)}function R(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);A.TYPED_ARRAY_SUPPORT?(t=e).__proto__=A.prototype:t=P(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!A.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|U(e,r),i=(t=T(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(B(e)){var r=0|k(e.length);return 0===(t=T(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?T(t,0):P(t,e);if("Buffer"===e.type&&x(e.data))return P(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function I(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function O(t,e){if(I(e),t=T(t,e<0?0:0|k(e)),!A.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function P(t,e){var r=e.length<0?0:0|k(e.length);t=T(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function k(t){if(t>=S())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+S().toString(16)+" bytes");return 0|t}function B(t){return!(null==t||!t._isBuffer)}function U(t,e){if(B(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return rt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return nt(t).length;default:if(n)return rt(t).length;e=(""+e).toLowerCase(),n=!0}}function C(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function L(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=A.from(e,n)),B(e))return 0===e.length?-1:j(t,e,r,n,i);if("number"==typeof e)return e&=255,A.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):j(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function j(t,e,r,n,i){var o,s=1,u=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;u/=s=2,c/=2,r/=2}function a(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=r;o<u;o++)if(a(t,o)===a(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===c)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(u<r+c&&(r=u-c),o=r;0<=o;o--){for(var h=!0,p=0;p<c;p++)if(a(t,o+p)!==a(e,p)){h=!1;break}if(h)return o}return-1}function z(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?i<(n=Number(n))&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<n&&(n=o/2);for(var s=0;s<n;++s){var u=parseInt(e.substr(2*s,2),16);if(isNaN(u))return s;t[r+s]=u}return s}function D(t,e,r,n){return it(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function M(t,e,r){return 0===e&&r===t.length?g(t):g(t.slice(e,r))}function F(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,u,c,a=t[i],f=null,h=239<a?4:223<a?3:191<a?2:1;if(i+h<=r)switch(h){case 1:a<128&&(f=a);break;case 2:128==(192&(o=t[i+1]))&&127<(c=(31&a)<<6|63&o)&&(f=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&2047<(c=(15&a)<<12|(63&o)<<6|63&s)&&(c<55296||57343<c)&&(f=c);break;case 4:o=t[i+1],s=t[i+2],u=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&u)&&65535<(c=(15&a)<<18|(63&o)<<12|(63&s)<<6|63&u)&&c<1114112&&(f=c)}null===f?(f=65533,h=1):65535<f&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=h}return function(t){var e=t.length;if(e<=Y)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Y));return r}(n)}A.TYPED_ARRAY_SUPPORT=void 0===r.TYPED_ARRAY_SUPPORT||r.TYPED_ARRAY_SUPPORT,A.poolSize=8192,A._augment=function(t){return t.__proto__=A.prototype,t},A.from=function(t,e,r){return R(null,t,e,r)},A.TYPED_ARRAY_SUPPORT&&(A.prototype.__proto__=Uint8Array.prototype,A.__proto__=Uint8Array),A.alloc=function(t,e,r){return function(t,e,r,n){return I(e),e<=0?T(t,e):void 0!==r?"string"==typeof n?T(t,e).fill(r,n):T(t,e).fill(r):T(t,e)}(null,t,e,r)},A.allocUnsafe=function(t){return O(null,t)},A.allocUnsafeSlow=function(t){return O(null,t)},A.isBuffer=ot,A.compare=function(t,e){if(!B(t)||!B(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},A.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(t,e){if(!x(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return A.alloc(0);var r;if(void 0===e)for(r=e=0;r<t.length;++r)e+=t[r].length;var n=A.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!B(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},A.byteLength=U,A.prototype._isBuffer=!0,A.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)C(this,e,e+1);return this},A.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)C(this,e,e+3),C(this,e+1,e+2);return this},A.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)C(this,e,e+7),C(this,e+1,e+6),C(this,e+2,e+5),C(this,e+3,e+4);return this},A.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?F(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return W(this,e,r);case"utf8":case"utf-8":return F(this,e,r);case"ascii":return V(this,e,r);case"latin1":case"binary":return H(this,e,r);case"base64":return M(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},A.prototype.equals=function(t){if(!B(t))throw new TypeError("Argument must be a Buffer");return this===t||0===A.compare(this,t)},A.prototype.inspect=function(){var t="";return 0<this.length&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(t+=" ... ")),"<Buffer "+t+">"},A.prototype.compare=function(t,e,r,n,i){if(!B(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=e)return 0;if(i<=n)return-1;if(r<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),u=Math.min(o,s),c=this.slice(n,i),a=t.slice(e,r),f=0;f<u;++f)if(c[f]!==a[f]){o=c[f],s=a[f];break}return o<s?-1:s<o?1:0},A.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},A.prototype.indexOf=function(t,e,r){return L(this,t,e,r,!0)},A.prototype.lastIndexOf=function(t,e,r){return L(this,t,e,r,!1)},A.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||i<r)&&(r=i),0<t.length&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var o,s,u,c,a,f,h,p,l,d=!1;;)switch(n){case"hex":return z(this,t,e,r);case"utf8":case"utf-8":return p=e,l=r,it(rt(t,(h=this).length-p),h,p,l);case"ascii":return D(this,t,e,r);case"latin1":case"binary":return D(this,t,e,r);case"base64":return c=this,a=e,f=r,it(nt(t),c,a,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s=e,u=r,it(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,(o=this).length-s),o,s,u);default:if(d)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),d=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;function V(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function H(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function W(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||n<r)&&(r=n);for(var i="",o=e;o<r;++o)i+=et(t[o]);return i}function q(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function J(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(r<t+e)throw new RangeError("Trying to access beyond buffer length")}function K(t,e,r,n,i,o){if(!B(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function G(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Q(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Z(t,e,r,n){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function X(t,e,r,n,i){return i||Z(t,0,r,4),_(t,e,r,n,23,4),r+4}function $(t,e,r,n,i){return i||Z(t,0,r,8),_(t,e,r,n,52,8),r+8}A.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),A.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=A.prototype;else{var i=e-t;r=new A(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},A.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||J(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},A.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||J(t,e,this.length);for(var n=this[t+--e],i=1;0<e&&(i*=256);)n+=this[t+--e]*i;return n},A.prototype.readUInt8=function(t,e){return e||J(t,1,this.length),this[t]},A.prototype.readUInt16LE=function(t,e){return e||J(t,2,this.length),this[t]|this[t+1]<<8},A.prototype.readUInt16BE=function(t,e){return e||J(t,2,this.length),this[t]<<8|this[t+1]},A.prototype.readUInt32LE=function(t,e){return e||J(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},A.prototype.readUInt32BE=function(t,e){return e||J(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},A.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||J(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*e)),n},A.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||J(t,e,this.length);for(var n=e,i=1,o=this[t+--n];0<n&&(i*=256);)o+=this[t+--n]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},A.prototype.readInt8=function(t,e){return e||J(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},A.prototype.readInt16LE=function(t,e){e||J(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt16BE=function(t,e){e||J(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt32LE=function(t,e){return e||J(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},A.prototype.readInt32BE=function(t,e){return e||J(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},A.prototype.readFloatLE=function(t,e){return e||J(t,4,this.length),m(this,t,!0,23,4)},A.prototype.readFloatBE=function(t,e){return e||J(t,4,this.length),m(this,t,!1,23,4)},A.prototype.readDoubleLE=function(t,e){return e||J(t,8,this.length),m(this,t,!0,52,8)},A.prototype.readDoubleBE=function(t,e){return e||J(t,8,this.length),m(this,t,!1,52,8)},A.prototype.writeUIntLE=function(t,e,r,n){t=+t,e|=0,r|=0,n||K(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},A.prototype.writeUIntBE=function(t,e,r,n){t=+t,e|=0,r|=0,n||K(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+r},A.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,1,255,0),A.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},A.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):G(this,t,e,!0),e+2},A.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):G(this,t,e,!1),e+2},A.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Q(this,t,e,!0),e+4},A.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Q(this,t,e,!1),e+4},A.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);K(this,t,e,r,i-1,-i)}var o=0,s=1,u=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+r},A.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);K(this,t,e,r,i-1,-i)}var o=r-1,s=1,u=0;for(this[e+o]=255&t;0<=--o&&(s*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+r},A.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,1,127,-128),A.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},A.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):G(this,t,e,!0),e+2},A.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):G(this,t,e,!1),e+2},A.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,4,2147483647,-2147483648),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Q(this,t,e,!0),e+4},A.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||K(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Q(this,t,e,!1),e+4},A.prototype.writeFloatLE=function(t,e,r){return X(this,t,e,!0,r)},A.prototype.writeFloatBE=function(t,e,r){return X(this,t,e,!1,r)},A.prototype.writeDoubleLE=function(t,e,r){return $(this,t,e,!0,r)},A.prototype.writeDoubleBE=function(t,e,r){return $(this,t,e,!1,r)},A.prototype.copy=function(t,e,r,n){if(r=r||0,n||0===n||(n=this.length),e>=t.length&&(e=t.length),e=e||0,0<n&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;0<=i;--i)t[i+e]=this[i+r];else if(o<1e3||!A.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},A.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!A.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(t=t||0))for(o=e;o<r;++o)this[o]=t;else{var s=B(t)?t:rt(new A(t,n).toString()),u=s.length;for(o=0;o<r-e;++o)this[o+e]=s[o%u]}return this};var tt=/[^+\/0-9A-Za-z-_]/g;function et(t){return t<16?"0"+t.toString(16):t.toString(16)}function rt(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if(55295<(r=t.charCodeAt(s))&&r<57344){if(!i){if(56319<r){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===n){-1<(e-=3)&&o.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(e-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function nt(t){return function(t){var e,r,n,i,o;v||b();var s=t.length;if(0<s%4)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[s-2]?2:"="===t[s-1]?1:0,o=new y(3*s/4-i),r=0<i?s-4:s;var u=0;for(e=0;e<r;e+=4,3)n=d[t.charCodeAt(e)]<<18|d[t.charCodeAt(e+1)]<<12|d[t.charCodeAt(e+2)]<<6|d[t.charCodeAt(e+3)],o[u++]=n>>16&255,o[u++]=n>>8&255,o[u++]=255&n;return 2==i?(n=d[t.charCodeAt(e)]<<2|d[t.charCodeAt(e+1)]>>4,o[u++]=255&n):1==i&&(n=d[t.charCodeAt(e)]<<10|d[t.charCodeAt(e+1)]<<4|d[t.charCodeAt(e+2)]>>2,o[u++]=n>>8&255,o[u++]=255&n),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(tt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function it(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function ot(t){return null!=t&&(!!t._isBuffer||st(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&st(t.slice(0,0))}(t))}function st(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function ut(t){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function at(t,e,r){return(at=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&ct(i,r.prototype),i}).apply(null,arguments)}function ft(t){var r="function"==typeof Map?new Map:void 0;return(ft=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return at(t,arguments,ut(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),ct(e,t)})(t)}function ht(t){return"string"==typeof t&&t.startsWith("0x")}function pt(t){return A.from(t.substr(2),"hex")}function lt(t){return ht(t)?t:"0x"+(ot(t)?t:A.from(t)).toString("hex")}var dt=function(){function e(t){if(u(this,"input",void 0),u(this,"hexValue",void 0),t instanceof e)return t;if(ht(t))this.input={type:"hex",value:t},this.hexValue=t;else if("string"==typeof t)this.input={type:"string",value:t},this.hexValue=lt(t);else if(Array.isArray(t))this.input={type:"bytesArray",value:t},this.hexValue=lt(t);else if(ot(t))this.input={type:"buffer",value:t},this.hexValue=lt(t);else{if("object"!=typeof t)throw new Error("Invalid input");this.input={type:"object",value:t},this.hexValue=lt(JSON.stringify(t))}}var t=e.prototype;return t.equals=function(t){return new e(t).value===this.hexValue},t.toBuffer=function(){switch(this.input.type){case"buffer":return this.input.value;case"bytesArray":case"string":return A.from(this.input.value);case"hex":return pt(this.input.value);case"object":return A.from(JSON.stringify(this.input.value));default:return A.alloc(0)}},t.toBytesArray=function(){return"bytesArray"===this.input.type?this.input.value:Array.from(this.toBuffer())},t.toObject=function(){return"object"===this.input.type?this.input.value:JSON.parse(this.toString())},t.toString=function(){switch(this.input.type){case"buffer":return this.input.value.toString();case"bytesArray":return A.from(this.input.value).toString();case"hex":return pt(this.input.value).toString();case"object":return JSON.stringify(this.input.value);case"string":return this.input.value;default:return""}},i(e,[{key:"value",get:function(){return this.hexValue}}]),e}();function yt(t){return new dt(t)}var vt=function(t,e){return(vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function bt(t,e){function r(){this.constructor=t}vt(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var wt=function(){return(wt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function gt(t){return"function"==typeof t}var mt=!1,_t={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;mt=t},get useDeprecatedSynchronousErrorHandling(){return mt}};function Et(t){setTimeout(function(){throw t},0)}var xt={closed:!0,next:function(t){},error:function(t){if(_t.useDeprecatedSynchronousErrorHandling)throw t;Et(t)},complete:function(){}},St=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function Tt(t){return null!==t&&"object"==typeof t}var At=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),Rt=function(){function u(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return u.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this._parentOrParents,r=this._unsubscribe,n=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof u)t.remove(this);else if(null!==t)for(var i=0;i<t.length;++i){t[i].remove(this)}if(gt(r))try{r.call(this)}catch(t){e=t instanceof At?It(t.errors):[t]}if(St(n)){i=-1;for(var o=n.length;++i<o;){var s=n[i];if(Tt(s))try{s.unsubscribe()}catch(t){e=e||[],t instanceof At?e=e.concat(It(t.errors)):e.push(t)}}}if(e)throw new At(e)}},u.prototype.add=function(t){var e=t;if(!t)return u.EMPTY;switch(typeof t){case"function":e=new u(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof u)){var r=e;(e=new u)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var n=e._parentOrParents;if(null===n)e._parentOrParents=this;else if(n instanceof u){if(n===this)return e;e._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return e;n.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[e]:i.push(e),e},u.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},u.EMPTY=((t=new u).closed=!0,t),u}();function It(t){return t.reduce(function(t,e){return t.concat(e instanceof At?e.errors:e)},[])}var Ot=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Pt=function(i){function o(t,e,r){var n=i.call(this)||this;switch(n.syncErrorValue=null,n.syncErrorThrown=!1,n.syncErrorThrowable=!1,n.isStopped=!1,arguments.length){case 0:n.destination=xt;break;case 1:if(!t){n.destination=xt;break}if("object"==typeof t){t instanceof o?(n.syncErrorThrowable=t.syncErrorThrowable,(n.destination=t).add(n)):(n.syncErrorThrowable=!0,n.destination=new kt(n,t));break}default:n.syncErrorThrowable=!0,n.destination=new kt(n,t,e,r)}return n}return bt(o,i),o.prototype[Ot]=function(){return this},o.create=function(t,e,r){var n=new o(t,e,r);return n.syncErrorThrowable=!1,n},o.prototype.next=function(t){this.isStopped||this._next(t)},o.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},o.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},o.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this))},o.prototype._next=function(t){this.destination.next(t)},o.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},o.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},o.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},o}(Rt),kt=function(u){function t(t,e,r,n){var i,o=u.call(this)||this;o._parentSubscriber=t;var s=o;return gt(e)?i=e:e&&(i=e.next,r=e.error,n=e.complete,e!==xt&&(gt((s=Object.create(e)).unsubscribe)&&o.add(s.unsubscribe.bind(s)),s.unsubscribe=o.unsubscribe.bind(o))),o._context=s,o._next=i,o._error=r,o._complete=n,o}return bt(t,u),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;_t.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=_t.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Et(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Et(t)}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};_t.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,r):this.__tryOrUnsub(r),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),_t.useDeprecatedSynchronousErrorHandling)throw t;Et(t)}},t.prototype.__tryOrSetError=function(e,t,r){if(!_t.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return _t.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0):(Et(t),!0)}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(Pt);var Nt=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Bt(){}var Ut=function(){function r(t){this._isScalar=!1,t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof Pt)return t;if(t[Ot])return t[Ot]()}return t||e||r?new Pt(t,e,r):new Pt(xt)}(t,e,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||_t.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),_t.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){_t.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof Pt?n:null}return!0}(e)?console.warn(t):e.error(t)}},r.prototype.forEach=function(n,t){var i=this;return new(t=Ct(t))(function(t,e){var r;r=i.subscribe(function(t){try{n(t)}catch(t){e(t),r&&r.unsubscribe()}},e,t)})},r.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},r.prototype[Nt]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:function(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:Bt}(t)(this)},r.prototype.toPromise=function(t){var n=this;return new(t=Ct(t))(function(t,e){var r;n.subscribe(function(t){return r=t},function(t){return e(t)},function(){return t(r)})})},r.create=function(t){return new r(t)},r}();function Ct(t){if(!(t=t||Promise))throw new Error("no Promise impl found");return t}var Lt=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),jt=function(n){function t(t,e){var r=n.call(this)||this;return r.subject=t,r.subscriber=e,r.closed=!1,r}return bt(t,n),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},t}(Rt),zt=function(r){function t(t){var e=r.call(this,t)||this;return e.destination=t,e}return bt(t,r),t}(Pt),Dt=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return bt(t,e),t.prototype[Ot]=function(){return new zt(this)},t.prototype.lift=function(t){var e=new Mt(this,this);return e.operator=t,e},t.prototype.next=function(t){if(this.closed)throw new Lt;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},t.prototype.error=function(t){if(this.closed)throw new Lt;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Lt;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Lt;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(t){if(this.closed)throw new Lt;return this.hasError?(t.error(this.thrownError),Rt.EMPTY):this.isStopped?(t.complete(),Rt.EMPTY):(this.observers.push(t),new jt(this,t))},t.prototype.asObservable=function(){var t=new Ut;return t.source=this,t},t.create=function(t,e){return new Mt(t,e)},t}(Ut),Mt=function(n){function t(t,e){var r=n.call(this)||this;return r.destination=t,r.source=e,r}return bt(t,n),t.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},t.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},t.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},t.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Rt.EMPTY},t}(Dt),Ft=function(n){function t(t,e){var r=n.call(this,t,e)||this;return r.scheduler=t,r.work=e,r.pending=!1,r}return bt(t,n),t.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},t.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},t.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},t.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},t}(function(r){function t(t,e){return r.call(this)||this}return bt(t,r),t.prototype.schedule=function(t,e){return this},t}(Rt)),Yt=function(n){function t(t,e){var r=n.call(this,t,e)||this;return r.scheduler=t,r.work=e,r}return bt(t,n),t.prototype.schedule=function(t,e){return void 0===e&&(e=0),0<e?n.prototype.schedule.call(this,t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,e){return 0<e||this.closed?n.prototype.execute.call(this,t,e):this._execute(t,e)},t.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),null!==r&&0<r||null===r&&0<this.delay?n.prototype.requestAsyncId.call(this,t,e,r):t.flush(this)},t}(Ft),Vt=function(){function r(t,e){void 0===e&&(e=r.now),this.SchedulerAction=t,this.now=e}return r.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},r.now=function(){return Date.now()},r}(),Ht=function(n){function i(t,e){void 0===e&&(e=Vt.now);var r=n.call(this,t,function(){return i.delegate&&i.delegate!==r?i.delegate.now():e()})||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return bt(i,n),i.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),i.delegate&&i.delegate!==this?i.delegate.schedule(t,e,r):n.prototype.schedule.call(this,t,e,r)},i.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},i}(Vt),Wt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bt(e,t),e}(Ht))(Yt),qt=new Ut(function(t){return t.complete()});function Jt(t){return t?function(e){return new Ut(function(t){return e.schedule(function(){return t.complete()})})}(t):qt}function Kt(t){return t&&"function"==typeof t.schedule}var Gt=function(n){return function(t){for(var e=0,r=n.length;e<r&&!t.closed;e++)t.next(n[e]);t.complete()}};function Qt(n,i){return new Ut(function(t){var e=new Rt,r=0;return e.add(i.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||e.add(this.schedule())):t.complete()})),e})}function Zt(t,e){return e?Qt(t,e):new Ut(Gt(t))}function Xt(t){var e=t.error;t.subscriber.error(e)}var $t=function(){function e(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return e.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},e.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},e.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},e.prototype.toObservable=function(){switch(this.kind){case"N":return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return Kt(r)?(t.pop(),Qt(t,r)):Zt(t)}(this.value);case"E":return function(e,r){return new Ut(r?function(t){return r.schedule(Xt,0,{error:e,subscriber:t})}:function(t){return t.error(e)})}(this.error);case"C":return Jt()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),te=function(i){function e(t,e,r){void 0===r&&(r=0);var n=i.call(this,t)||this;return n.scheduler=e,n.delay=r,n}return bt(e,i),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new ee(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage($t.createNext(t))},e.prototype._error=function(t){this.scheduleMessage($t.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage($t.createComplete()),this.unsubscribe()},e}(Pt),ee=function(){return function(t,e){this.notification=t,this.destination=e}}(),re=function(i){function t(t,e,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===e&&(e=Number.POSITIVE_INFINITY);var n=i.call(this)||this;return n.scheduler=r,n._events=[],n._infiniteTimeWindow=!1,n._bufferSize=t<1?1:t,n._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(n._infiniteTimeWindow=!0,n.next=n.nextInfiniteTimeWindow):n.next=n.nextTimeWindow,n}return bt(t,i),t.prototype.nextInfiniteTimeWindow=function(t){var e=this._events;e.push(t),e.length>this._bufferSize&&e.shift(),i.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new ne(this._getNow(),t)),this._trimBufferThenGetEvents(),i.prototype.next.call(this,t)},t.prototype._subscribe=function(t){var e,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=n.length;if(this.closed)throw new Lt;if(e=this.isStopped||this.hasError?Rt.EMPTY:(this.observers.push(t),new jt(this,t)),i&&t.add(t=new te(t,i)),r)for(var s=0;s<o&&!t.closed;s++)t.next(n[s]);else for(s=0;s<o&&!t.closed;s++)t.next(n[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},t.prototype._getNow=function(){return(this.scheduler||Wt).now()},t.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,n=this._events,i=n.length,o=0;o<i&&!(t-n[o].time<r);)o++;return e<i&&(o=Math.max(o,i-e)),0<o&&n.splice(0,o),n},t}(Dt),ne=function(){return function(t,e){this.time=t,this.value=e}}(),ie=new Ht(Ft);function oe(t){return t}var se=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ue(t,this.project,this.thisArg))},t}(),ue=function(i){function t(t,e,r){var n=i.call(this,t)||this;return n.project=e,n.count=0,n.thisArg=r||n,n}return bt(t,i),t.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},t}(Pt),ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bt(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(Pt),ae=function(i){function t(t,e,r){var n=i.call(this)||this;return n.parent=t,n.outerValue=e,n.outerIndex=r,n.index=0,n}return bt(t,i),t.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},t.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Pt);function fe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var he=fe(),pe=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function le(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var de=function(t){if(t&&"function"==typeof t[Nt])return function(r){return function(t){var e=r[Nt]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)}}(t);if(pe(t))return Gt(t);if(le(t))return function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Et),e}}(t);if(t&&"function"==typeof t[he])return function(n){return function(t){for(var e=n[he]();;){var r=e.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof e.return&&t.add(function(){e.return&&e.return()}),t}}(t);var e=Tt(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ye(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[Nt]}(t))return function(n,i){return new Ut(function(e){var r=new Rt;return r.add(i.schedule(function(){var t=n[Nt]();r.add(t.subscribe({next:function(t){r.add(i.schedule(function(){return e.next(t)}))},error:function(t){r.add(i.schedule(function(){return e.error(t)}))},complete:function(){r.add(i.schedule(function(){return e.complete()}))}}))})),r})}(t,e);if(le(t))return function(t,n){return new Ut(function(e){var r=new Rt;return r.add(n.schedule(function(){return t.then(function(t){r.add(n.schedule(function(){e.next(t),r.add(n.schedule(function(){return e.complete()}))}))},function(t){r.add(n.schedule(function(){return e.error(t)}))})})),r})}(t,e);if(pe(t))return Qt(t,e);if(function(t){return t&&"function"==typeof t[he]}(t)||"string"==typeof t)return function(e,r){if(!e)throw new Error("Iterable cannot be null");return new Ut(function(n){var i,t=new Rt;return t.add(function(){i&&"function"==typeof i.return&&i.return()}),t.add(r.schedule(function(){i=e[he](),t.add(r.schedule(function(){if(!n.closed){var t,e;try{var r=i.next();t=r.value,e=r.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}}))})),t})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function ve(e,i,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof i?function(t){return t.pipe(ve(function(r,n){return function(t,e){return e?ye(t,e):t instanceof Ut?t:new Ut(de(t))}(e(r,n)).pipe(function(e,r){return function(t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new se(e,r))}}(function(t,e){return i(r,t,n,e)}))},r))}:("number"==typeof i&&(r=i),function(t){return t.lift(new be(e,r))})}var be=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new we(t,this.project,this.concurrent))},t}(),we=function(i){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var n=i.call(this,t)||this;return n.project=e,n.concurrent=r,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return bt(t,i),t.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},t.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},t.prototype._innerSub=function(t,e,r){var n=new ae(this,void 0,void 0);this.destination.add(n),function(t,e,r,n,i){if(void 0===i&&(i=new ae(t,r,n)),!i.closed)e instanceof Ut?e.subscribe(i):de(e)(i)}(this,t,e,r,n)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},t.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(ce);function ge(e,r){return void 0===e&&(e=0),void 0===r&&(r=ie),(!function(t){return!St(t)&&0<=t-parseFloat(t)+1}(e)||e<0)&&(e=0),r&&"function"==typeof r.schedule||(r=ie),new Ut(function(t){return t.add(r.schedule(me,e,{subscriber:t,counter:0,period:e})),t})}function me(t){var e=t.subscriber,r=t.counter,n=t.period;e.next(r),this.schedule({subscriber:e,counter:r+1,period:n},n)}function _e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return Kt(i)?(n=t.pop(),1<t.length&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof Ut?t[0]:function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),ve(oe,t)}(r)(Zt(t,n))}var Ee=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new xe(t,this.predicate,this.thisArg))},t}(),xe=function(i){function t(t,e,r){var n=i.call(this,t)||this;return n.predicate=e,n.thisArg=r,n.count=0,n}return bt(t,i),t.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},t}(Pt);var Se=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Te(t,this.compare,this.keySelector))},t}(),Te=function(i){function t(t,e,r){var n=i.call(this,t)||this;return n.keySelector=r,n.hasKey=!1,"function"==typeof e&&(n.compare=e),n}return bt(t,i),t.prototype.compare=function(t,e){return t===e},t.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},t}(Pt);function Ae(){throw new Error("setTimeout has not been defined")}function Re(){throw new Error("clearTimeout has not been defined")}var Ie=Ae,Oe=Re;function Pe(e){if(Ie===setTimeout)return setTimeout(e,0);if((Ie===Ae||!Ie)&&setTimeout)return Ie=setTimeout,setTimeout(e,0);try{return Ie(e,0)}catch(t){try{return Ie.call(null,e,0)}catch(t){return Ie.call(this,e,0)}}}"function"==typeof r.setTimeout&&(Ie=setTimeout),"function"==typeof r.clearTimeout&&(Oe=clearTimeout);var ke,Ne=[],Be=!1,Ue=-1;function Ce(){Be&&ke&&(Be=!1,ke.length?Ne=ke.concat(Ne):Ue=-1,Ne.length&&Le())}function Le(){if(!Be){var t=Pe(Ce);Be=!0;for(var e=Ne.length;e;){for(ke=Ne,Ne=[];++Ue<e;)ke&&ke[Ue].run();Ue=-1,e=Ne.length}ke=null,Be=!1,function(e){if(Oe===clearTimeout)return clearTimeout(e);if((Oe===Re||!Oe)&&clearTimeout)return Oe=clearTimeout,clearTimeout(e);try{Oe(e)}catch(t){try{return Oe.call(null,e)}catch(t){return Oe.call(this,e)}}}(t)}}function je(t,e){this.fun=t,this.array=e}je.prototype.run=function(){this.fun.apply(null,this.array)};function ze(){}var De=ze,Me=ze,Fe=ze,Ye=ze,Ve=ze,He=ze,We=ze;var qe=r.performance||{},Je=qe.now||qe.mozNow||qe.msNow||qe.oNow||qe.webkitNow||function(){return(new Date).getTime()};var Ke=new Date;var Ge={nextTick:function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ne.push(new je(t,e)),1!==Ne.length||Be||Pe(Le)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:De,addListener:Me,once:Fe,off:Ye,removeListener:Ve,removeAllListeners:He,emit:We,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Je.call(qe),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ke)/1e3}},Qe=e(function(k){!function(){var h="input is invalid type",t="object"==typeof window,e=t?window:{};e.JS_SHA3_NO_WINDOW&&(t=!1);var r=!t&&"object"==typeof self;!e.JS_SHA3_NO_NODE_JS&&"object"==typeof Ge&&Ge.versions&&Ge.versions.node?e=N:r&&(e=self);var n=!e.JS_SHA3_NO_COMMON_JS&&k.exports,p=!e.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),i=[4,1024,262144,67108864],l=[0,8,16,24],ft=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],o=[224,256,384,512],s=[128,256],u=["hex","buffer","arrayBuffer","array","digest"],a={128:168,256:136};!e.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!p||!e.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var f=function(e,r,n){return function(t){return new I(e,r,e).update(t)[n]()}},d=function(r,n,i){return function(t,e){return new I(r,n,e).update(t)[i]()}},y=function(i,t,o){return function(t,e,r,n){return m["cshake"+i].update(t,e,r,n)[o]()}},v=function(i,t,o){return function(t,e,r,n){return m["kmac"+i].update(t,e,r,n)[o]()}},b=function(t,e,r,n){for(var i=0;i<u.length;++i){var o=u[i];t[o]=e(r,n,o)}return t},w=function(t,e){var r=f(t,e,"hex");return r.create=function(){return new I(t,e,t)},r.update=function(t){return r.create().update(t)},b(r,f,t,e)},g=[{name:"keccak",padding:[1,256,65536,16777216],bits:o,createMethod:w},{name:"sha3",padding:[6,1536,393216,100663296],bits:o,createMethod:w},{name:"shake",padding:[31,7936,2031616,520093696],bits:s,createMethod:function(e,r){var n=d(e,r,"hex");return n.create=function(t){return new I(e,r,t)},n.update=function(t,e){return n.create(e).update(t)},b(n,d,e,r)}},{name:"cshake",padding:i,bits:s,createMethod:function(n,i){var o=a[n],s=y(n,0,"hex");return s.create=function(t,e,r){return e||r?new I(n,i,t).bytepad([e,r],o):m["shake"+n].create(t)},s.update=function(t,e,r,n){return s.create(e,r,n).update(t)},b(s,y,n,i)}},{name:"kmac",padding:i,bits:s,createMethod:function(n,i){var o=a[n],s=v(n,0,"hex");return s.create=function(t,e,r){return new O(n,i,e).bytepad(["KMAC",r],o).bytepad([t],o)},s.update=function(t,e,r,n){return s.create(t,r,n).update(e)},b(s,v,n,i)}}],m={},_=[],E=0;E<g.length;++E)for(var x=g[E],S=x.bits,T=0;T<S.length;++T){var A=x.name+"_"+S[T];if(_.push(A),m[A]=x.createMethod(S[T],x.padding),"sha3"!==x.name){var R=x.name+S[T];_.push(R),m[R]=m[A]}}function I(t,e,r){this.blocks=[],this.s=[],this.padding=e,this.outputBits=r,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var n=0;n<50;++n)this.s[n]=0}function O(t,e,r){I.call(this,t,e,r)}I.prototype.update=function(t){if(this.finalized)throw new Error("finalize already called");var e,r=typeof t;if("string"!=r){if("object"!=r)throw new Error(h);if(null===t)throw new Error(h);if(p&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||p&&ArrayBuffer.isView(t)))throw new Error(h);e=!0}for(var n,i,o=this.blocks,s=this.byteCount,u=t.length,c=this.blockCount,a=0,f=this.s;a<u;){if(this.reset)for(this.reset=!1,o[0]=this.block,n=1;n<c+1;++n)o[n]=0;if(e)for(n=this.start;a<u&&n<s;++a)o[n>>2]|=t[a]<<l[3&n++];else for(n=this.start;a<u&&n<s;++a)(i=t.charCodeAt(a))<128?o[n>>2]|=i<<l[3&n++]:(i<2048?o[n>>2]|=(192|i>>6)<<l[3&n++]:(i<55296||57344<=i?o[n>>2]|=(224|i>>12)<<l[3&n++]:(i=65536+((1023&i)<<10|1023&t.charCodeAt(++a)),o[n>>2]|=(240|i>>18)<<l[3&n++],o[n>>2]|=(128|i>>12&63)<<l[3&n++]),o[n>>2]|=(128|i>>6&63)<<l[3&n++]),o[n>>2]|=(128|63&i)<<l[3&n++]);if(s<=(this.lastByteIndex=n)){for(this.start=n-s,this.block=o[c],n=0;n<c;++n)f[n]^=o[n];P(f),this.reset=!0}else this.start=n}return this},I.prototype.encode=function(t,e){var r=255&t,n=1,i=[r];for(r=255&(t>>=8);0<r;)i.unshift(r),r=255&(t>>=8),++n;return e?i.push(n):i.unshift(n),this.update(i),i.length},I.prototype.encodeString=function(t){var e,r=typeof t;if("string"!=r){if("object"!=r)throw new Error(h);if(null===t)throw new Error(h);if(p&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||p&&ArrayBuffer.isView(t)))throw new Error(h);e=!0}var n=0,i=t.length;if(e)n=i;else for(var o=0;o<t.length;++o){var s=t.charCodeAt(o);s<128?n+=1:s<2048?n+=2:s<55296||57344<=s?n+=3:(s=65536+((1023&s)<<10|1023&t.charCodeAt(++o)),n+=4)}return n+=this.encode(8*n),this.update(t),n},I.prototype.bytepad=function(t,e){for(var r=this.encode(e),n=0;n<t.length;++n)r+=this.encodeString(t[n]);var i=e-r%e,o=[];return o.length=i,this.update(o),this},I.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,r=this.blockCount,n=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[r],e=1;e<r+1;++e)t[e]=0;for(t[r-1]|=2147483648,e=0;e<r;++e)n[e]^=t[e];P(n)}},I.prototype.toString=I.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,r=this.s,n=this.outputBlocks,i=this.extraBytes,o=0,s=0,u="";s<n;){for(o=0;o<e&&s<n;++o,++s)t=r[o],u+=c[t>>4&15]+c[15&t]+c[t>>12&15]+c[t>>8&15]+c[t>>20&15]+c[t>>16&15]+c[t>>28&15]+c[t>>24&15];s%e==0&&(P(r),o=0)}return i&&(t=r[o],u+=c[t>>4&15]+c[15&t],1<i&&(u+=c[t>>12&15]+c[t>>8&15]),2<i&&(u+=c[t>>20&15]+c[t>>16&15])),u},I.prototype.buffer=I.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,r=this.s,n=this.outputBlocks,i=this.extraBytes,o=0,s=0,u=this.outputBits>>3;t=i?new ArrayBuffer(n+1<<2):new ArrayBuffer(u);for(var c=new Uint32Array(t);s<n;){for(o=0;o<e&&s<n;++o,++s)c[s]=r[o];s%e==0&&P(r)}return i&&(c[o]=r[o],t=t.slice(0,u)),t},I.prototype.digest=I.prototype.array=function(){this.finalize();for(var t,e,r=this.blockCount,n=this.s,i=this.outputBlocks,o=this.extraBytes,s=0,u=0,c=[];u<i;){for(s=0;s<r&&u<i;++s,++u)t=u<<2,e=n[s],c[t]=255&e,c[t+1]=e>>8&255,c[t+2]=e>>16&255,c[t+3]=e>>24&255;u%r==0&&P(n)}return o&&(t=u<<2,e=n[s],c[t]=255&e,1<o&&(c[t+1]=e>>8&255),2<o&&(c[t+2]=e>>16&255)),c},(O.prototype=new I).finalize=function(){return this.encode(this.outputBits,!0),I.prototype.finalize.call(this)};var P=function(t){var e,r,n,i,o,s,u,c,a,f,h,p,l,d,y,v,b,w,g,m,_,E,x,S,T,A,R,I,O,P,k,N,B,U,C,L,j,z,D,M,F,Y,V,H,W,q,J,K,G,Q,Z,X,$,tt,et,rt,nt,it,ot,st,ut,ct,at;for(n=0;n<48;n+=2)i=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],s=t[2]^t[12]^t[22]^t[32]^t[42],u=t[3]^t[13]^t[23]^t[33]^t[43],c=t[4]^t[14]^t[24]^t[34]^t[44],a=t[5]^t[15]^t[25]^t[35]^t[45],f=t[6]^t[16]^t[26]^t[36]^t[46],h=t[7]^t[17]^t[27]^t[37]^t[47],e=(p=t[8]^t[18]^t[28]^t[38]^t[48])^(s<<1|u>>>31),r=(l=t[9]^t[19]^t[29]^t[39]^t[49])^(u<<1|s>>>31),t[0]^=e,t[1]^=r,t[10]^=e,t[11]^=r,t[20]^=e,t[21]^=r,t[30]^=e,t[31]^=r,t[40]^=e,t[41]^=r,e=i^(c<<1|a>>>31),r=o^(a<<1|c>>>31),t[2]^=e,t[3]^=r,t[12]^=e,t[13]^=r,t[22]^=e,t[23]^=r,t[32]^=e,t[33]^=r,t[42]^=e,t[43]^=r,e=s^(f<<1|h>>>31),r=u^(h<<1|f>>>31),t[4]^=e,t[5]^=r,t[14]^=e,t[15]^=r,t[24]^=e,t[25]^=r,t[34]^=e,t[35]^=r,t[44]^=e,t[45]^=r,e=c^(p<<1|l>>>31),r=a^(l<<1|p>>>31),t[6]^=e,t[7]^=r,t[16]^=e,t[17]^=r,t[26]^=e,t[27]^=r,t[36]^=e,t[37]^=r,t[46]^=e,t[47]^=r,e=f^(i<<1|o>>>31),r=h^(o<<1|i>>>31),t[8]^=e,t[9]^=r,t[18]^=e,t[19]^=r,t[28]^=e,t[29]^=r,t[38]^=e,t[39]^=r,t[48]^=e,t[49]^=r,d=t[0],y=t[1],q=t[11]<<4|t[10]>>>28,J=t[10]<<4|t[11]>>>28,I=t[20]<<3|t[21]>>>29,O=t[21]<<3|t[20]>>>29,st=t[31]<<9|t[30]>>>23,ut=t[30]<<9|t[31]>>>23,Y=t[40]<<18|t[41]>>>14,V=t[41]<<18|t[40]>>>14,U=t[2]<<1|t[3]>>>31,C=t[3]<<1|t[2]>>>31,v=t[13]<<12|t[12]>>>20,b=t[12]<<12|t[13]>>>20,K=t[22]<<10|t[23]>>>22,G=t[23]<<10|t[22]>>>22,P=t[33]<<13|t[32]>>>19,k=t[32]<<13|t[33]>>>19,ct=t[42]<<2|t[43]>>>30,at=t[43]<<2|t[42]>>>30,tt=t[5]<<30|t[4]>>>2,et=t[4]<<30|t[5]>>>2,L=t[14]<<6|t[15]>>>26,j=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,g=t[24]<<11|t[25]>>>21,Q=t[34]<<15|t[35]>>>17,Z=t[35]<<15|t[34]>>>17,N=t[45]<<29|t[44]>>>3,B=t[44]<<29|t[45]>>>3,S=t[6]<<28|t[7]>>>4,T=t[7]<<28|t[6]>>>4,rt=t[17]<<23|t[16]>>>9,nt=t[16]<<23|t[17]>>>9,z=t[26]<<25|t[27]>>>7,D=t[27]<<25|t[26]>>>7,m=t[36]<<21|t[37]>>>11,_=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,$=t[46]<<24|t[47]>>>8,H=t[8]<<27|t[9]>>>5,W=t[9]<<27|t[8]>>>5,A=t[18]<<20|t[19]>>>12,R=t[19]<<20|t[18]>>>12,it=t[29]<<7|t[28]>>>25,ot=t[28]<<7|t[29]>>>25,M=t[38]<<8|t[39]>>>24,F=t[39]<<8|t[38]>>>24,E=t[48]<<14|t[49]>>>18,x=t[49]<<14|t[48]>>>18,t[0]=d^~v&w,t[1]=y^~b&g,t[10]=S^~A&I,t[11]=T^~R&O,t[20]=U^~L&z,t[21]=C^~j&D,t[30]=H^~q&K,t[31]=W^~J&G,t[40]=tt^~rt&it,t[41]=et^~nt&ot,t[2]=v^~w&m,t[3]=b^~g&_,t[12]=A^~I&P,t[13]=R^~O&k,t[22]=L^~z&M,t[23]=j^~D&F,t[32]=q^~K&Q,t[33]=J^~G&Z,t[42]=rt^~it&st,t[43]=nt^~ot&ut,t[4]=w^~m&E,t[5]=g^~_&x,t[14]=I^~P&N,t[15]=O^~k&B,t[24]=z^~M&Y,t[25]=D^~F&V,t[34]=K^~Q&X,t[35]=G^~Z&$,t[44]=it^~st&ct,t[45]=ot^~ut&at,t[6]=m^~E&d,t[7]=_^~x&y,t[16]=P^~N&S,t[17]=k^~B&T,t[26]=M^~Y&U,t[27]=F^~V&C,t[36]=Q^~X&H,t[37]=Z^~$&W,t[46]=st^~ct&tt,t[47]=ut^~at&et,t[8]=E^~d&v,t[9]=x^~y&b,t[18]=N^~S&A,t[19]=B^~T&R,t[28]=Y^~U&L,t[29]=V^~C&j,t[38]=X^~H&q,t[39]=$^~W&J,t[48]=ct^~tt&rt,t[49]=at^~et&nt,t[0]^=ft[n],t[1]^=ft[n+1]};if(n)k.exports=m;else for(E=0;E<_.length;++E)e[_[E]]=m[_[E]]}()});var Ze=32,Xe=20,$e=7,tr=1,er=8;function rr(t,e){var r=yt(t.feed.topic).toBuffer();if(r.length!==Ze)throw new Error("Invalid topic length");var n=yt(t.feed.user).toBuffer();if(n.length!==Xe)throw new Error("Invalid user length");var i=A.alloc(er,0);i.writeInt8(t.protocolVersion,0);var o=A.alloc($e,0);o.writeUInt32LE(t.epoch.time,0);var s=A.alloc(tr,0);return s.writeUInt8(t.epoch.level,0),function(t){return Qe.keccak256.array(t)}(A.concat([i,r,n,o,s,yt(e).toBuffer()]))}function nr(t){var e=yt(t.topic||A.alloc(Ze));if(null==t.name)return e.value;var r=A.from(t.name),n=e.toBuffer();return lt(Array(Ze).fill(0).map(function(t,e){return n[e]^r[e]}))}var ir={default:"bzz:/",feed:"bzz-feed:/",immutable:"bzz-immutable:/",pin:"bzz-pin:/",raw:"bzz-raw:/",tag:"bzz-tag:/"};var or=function(n){function t(t,e){var r;return u(o(r=n.call(this,e)||this),"status",void 0),r.status=t,r}return s(t,n),t}(ft(Error));function sr(t){if(t.ok)return t;throw new or(t.status,t.statusText)}function ur(){return cr.apply(this,arguments)}function cr(){return(cr=a(f.mark(function t(e){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sr(e).json();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)}function ar(){return fr.apply(this,arguments)}function fr(){return(fr=a(f.mark(function t(e){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sr(e).text();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)}function hr(){return pr.apply(this,arguments)}function pr(){return(pr=a(f.mark(function t(e){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ar(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)}function lr(){return dr.apply(this,arguments)}function dr(){return(dr=a(f.mark(function t(e){var r;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sr(e).arrayBuffer();case 2:return r=t.sent,t.abrupt("return",A.from(new Uint8Array(r)).toString("hex"));case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}function yr(){return Promise.reject(new Error("Missing `signBytes()` function"))}function vr(t){return{address:t.Address,counter:t.PinCounter,raw:t.IsRaw,size:t.FileSize}}var br=function(n){function t(t){var e=t.url,r=p(t,["url"]);return n.call(this,window.fetch.bind(window),h({},r,{url:new URL(e).href}))||this}return s(t,n),t.prototype.uploadDirectory=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n=new FormData,Object.keys(e).forEach(function(t){n.append(t,new Blob([e[t].data],{type:e[t].contentType}),t)}),null!=r.defaultPath&&null!=(i=e[r.defaultPath])&&n.append("",new Blob([i.data],{type:i.contentType}),""),r.pin&&(null==r.headers&&(r.headers={}),r.headers["x-swarm-pin"]=!0),t.next=7,this.uploadBody(n,r);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),t}(function(){function t(t,e){u(this,"defaultTimeout",void 0),u(this,"fetch",void 0),u(this,"signBytes",void 0),u(this,"url",void 0);var r=e.url,n=e.timeout;this.fetch=t,this.defaultTimeout=n||0,this.signBytes=e.signBytes||yr,this.url=r}var e=t.prototype;return e.fetchTimeout=function(n,t,i){var o=this;void 0===i&&(i={});var s=null==t.timeout?this.defaultTimeout:t.timeout;return null!=t.headers&&(i.headers=t.headers),0===s?this.fetch(n,i):new Promise(function(e,t){var r=setTimeout(function(){t(new Error("Timeout"))},s);o.fetch(n,i).then(function(t){clearTimeout(r),e(t)})})},e.sign=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signBytes(e,r);case 2:return n=t.sent,t.abrupt("return",lt(n));case 4:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.getDownloadURL=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r=!1);var n=r?ir.raw:function(t){return t&&ir[t]||ir.default}(e.mode),i=""+this.url+n+t+"/";return null!=e.path&&(i+=e.path),"raw"===e.mode&&null!=e.contentType&&(i+="?content_type="+e.contentType),i},e.getUploadURL=function(t,e){void 0===t&&(t={}),void 0===e&&(e=!1);var r=this.url+ir[e?"raw":"default"];return null!=t.manifestHash&&(r+=t.manifestHash+"/",null!=t.path&&(r+=t.path)),null!=t.defaultPath&&(r+="?defaultpath="+t.defaultPath),r},e.getFeedURL=function(t,e){var r=this.url+ir.feed,n=[];if("string"==typeof t)r+=t+"/";else{var i=t;Object.keys(i).forEach(function(t){var e=i[t];null!=e&&n.push(t+"="+e)})}return null!=e&&n.push(e+"=1"),0<n.length?r+"?"+n.join("&"):r},e.getPinURL=function(t,e){void 0===e&&(e=!1);var r=this.url+ir.pin;return null!=t&&(r+=t),e&&(r+="/?raw=true"),r},e.hash=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),t.next=3,this.fetchTimeout(this.url+"bzz-hash:/"+e,r);case 3:return n=t.sent,t.next=6,hr(n);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.list=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n=this.url+"bzz-list:/"+e+"/",null!=r.path&&(n+=r.path),t.next=5,this.fetchTimeout(n,r);case 5:return i=t.sent,t.next=8,ur(i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.download=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n=this.getDownloadURL(e,r),t.next=4,this.fetchTimeout(n,r);case 4:return i=t.sent,t.abrupt("return",sr(i));case 6:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.uploadBody=function(){var n=a(f.mark(function t(e,r,n){var i,o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=!1),i=this.getUploadURL(r,n),t.next=4,this.fetchTimeout(i,r,{body:e,method:"POST"});case 4:return o=t.sent,t.next=7,hr(o);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,e,r){return n.apply(this,arguments)}}(),e.uploadFile=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n="string"==typeof e?A.from(e):e,i=null==r.contentType,null==r.headers&&(r.headers={}),r.headers["content-length"]=null==r.size?n.length:r.size,null!=r.headers["content-type"]||i||(r.headers["content-type"]=r.contentType),r.pin&&(r.headers["x-swarm-pin"]=!0),t.next=9,this.uploadBody(n,r,i);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.uploadDirectory=function(t,e){return Promise.reject(new Error("Must be implemented in extending class"))},e.upload=function(){var r=a(f.mark(function t(e,r){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r={}),"string"==typeof e||ot(e))return t.next=4,this.uploadFile(e,r);t.next=7;break;case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,this.uploadDirectory(e,r);case 9:t.t0=t.sent;case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.deleteResource=function(){var n=a(f.mark(function t(e,r,n){var i,o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),i=this.getUploadURL({manifestHash:e,path:r}),t.next=4,this.fetchTimeout(i,n,{method:"DELETE"});case 4:return o=t.sent,t.next=7,hr(o);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,e,r){return n.apply(this,arguments)}}(),e.createFeedManifest=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n={entries:[{contentType:"application/bzz-feed",mod_time:"0001-01-01T00:00:00Z",feed:{topic:nr(e),user:e.user}}]},t.next=4,this.uploadFile(JSON.stringify(n),r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.getFeedMetadata=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n=this.getFeedURL(e,"meta"),t.next=4,this.fetchTimeout(n,r);case 4:return i=t.sent,t.next=7,ur(i);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.getFeedChunk=function(){var r=a(f.mark(function t(e,r){var n,i;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),n=this.getFeedURL(e),t.next=4,this.fetchTimeout(n,r);case 4:return i=t.sent,t.abrupt("return",sr(i));case 6:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.getFeedContentHash=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),t.next=3,this.getFeedChunk(e,r);case 3:return n=t.sent,t.next=6,lr(n);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.getFeedContent=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),t.next=3,this.getFeedContentHash(e,{headers:r.headers,timeout:r.timeout});case 3:return n=t.sent,t.next=6,this.download(n,r);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.pollFeedChunk=function(t,e){var r,n=this,i=[];!1!==e.immediate&&i.push([0]),null!=e.trigger&&i.push(e.trigger);var o=[];if("error"===e.whenEmpty)o.push(ve(function(){return n.getFeedChunk(t,e)}));else{var s=this.getFeedURL(t);o.push(ve(function(){return n.fetchTimeout(s,e).then(function(t){return 404===t.status?null:t.ok?t:new or(t.status,t.statusText)})})),"ignore"===e.whenEmpty&&o.push(function(e,r){return function(t){return t.lift(new Ee(e,r))}}(function(t){return null!==t}))}return(r=_e.apply(void 0,[ge(e.interval)].concat(i))).pipe.apply(r,o)},e.pollFeedContentHash=function(t,e){var r,n=[ve(function(t){return null===t?Promise.resolve(null):lr(t)})];return e.changedOnly&&n.push(function(e,r){return function(t){return t.lift(new Se(e,r))}}()),(r=this.pollFeedChunk(t,e)).pipe.apply(r,n)},e.pollFeedContent=function(t,e){var r=this;return this.pollFeedContentHash(t,e).pipe(ve(function(t){return null===t?Promise.resolve(null):r.download(t,e)}))},e.postSignedFeedChunk=function(){var n=a(f.mark(function t(e,r,n){var i,o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),i=this.getFeedURL(e),t.next=4,this.fetchTimeout(i,n,{method:"POST",body:r});case 4:return o=t.sent,t.abrupt("return",sr(o));case 6:case"end":return t.stop()}},t,this)}));return function(t,e,r){return n.apply(this,arguments)}}(),e.postFeedChunk=function(){var i=a(f.mark(function t(e,r,n,i){var o,s,u;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=yt(r).toBuffer(),s=rr(e,o),t.next=4,this.sign(s,i);case 4:return u=t.sent,t.next=7,this.postSignedFeedChunk({user:e.feed.user,topic:e.feed.topic,time:e.epoch.time,level:e.epoch.level,signature:u},o,n);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,e,r,n){return i.apply(this,arguments)}}(),e.setFeedChunk=function(){var i=a(f.mark(function t(e,r,n,i){var o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getFeedMetadata(e,n);case 2:return o=t.sent,t.next=5,this.postFeedChunk(o,r,n,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(t,e,r,n){return i.apply(this,arguments)}}(),e.setFeedContentHash=function(){var i=a(f.mark(function t(e,r,n,i){var o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getFeedMetadata(e,n);case 2:return o=t.sent,t.next=5,this.postFeedChunk(o,"0x"+r,n,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(t,e,r,n){return i.apply(this,arguments)}}(),e.setFeedContent=function(){var i=a(f.mark(function t(e,r,n,i){var o,s,u,c,a;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),(o=n).contentType,s=p(o,["contentType"]),t.next=4,Promise.all([this.upload(r,n),this.getFeedMetadata(e,s)]);case 4:return u=t.sent,c=u[0],a=u[1],t.next=9,this.postFeedChunk(a,"0x"+c,s,i);case 9:return t.abrupt("return",c);case 10:case"end":return t.stop()}},t,this)}));return function(t,e,r,n){return i.apply(this,arguments)}}(),e.pinEnabled=function(){var e=a(f.mark(function t(e){var r;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),t.next=3,this.fetchTimeout(this.getPinURL(),e);case 3:return r=t.sent,t.abrupt("return",r.ok);case 5:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),e.pin=function(){var r=a(f.mark(function t(e,r){var n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r={}),r.download)return t.next=4,this.download(e,{mode:r.raw?"raw":"default"});t.next=4;break;case 4:return n=this.getPinURL(e,r.raw),t.next=7,this.fetchTimeout(n,r,{method:"POST"});case 7:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.unpin=function(){var r=a(f.mark(function t(e,r){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r={}),t.next=3,this.fetchTimeout(this.getPinURL(e),r,{method:"DELETE"});case 3:case"end":return t.stop()}},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.pins=function(){var e=a(f.mark(function t(e){var r,n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),t.next=3,this.fetchTimeout(this.getPinURL(),e);case 3:return r=t.sent,t.next=6,ur(r);case 6:return n=t.sent,t.abrupt("return",n.map(vr));case 8:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),e.getTag=function(){var r=a(f.mark(function t(r,n){var i,o;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),t.next=3,this.fetchTimeout(this.url+ir.tag+r,n);case 3:return i=t.sent,t.next=6,ur(i);case 6:return o=t.sent,t.abrupt("return",{uid:(e=o).Uid,name:e.Name,address:e.Address,total:e.Total,split:e.Split,seen:e.Seen,stored:e.Stored,sent:e.Sent,synced:e.Synced,startedAt:new Date(e.StartedAt)});case 8:case"end":return t.stop()}var e},t,this)}));return function(t,e){return r.apply(this,arguments)}}(),e.pollTag=function(e,r){var n=this,t=[];return!1!==r.immediate&&t.push([0]),_e.apply(void 0,[ge(r.interval)].concat(t)).pipe(ve(a(f.mark(function t(){return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getTag(e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))))},t}()),wr=function(){function t(t){if(u(this,"rpc",void 0),!t.canSubscribe)throw new Error("Invalid RPC instance provided: must support subscriptions");this.rpc=t}var e=t.prototype;return e.baseAddr=function(){return this.rpc.request("pss_baseAddr")},e.getPublicKey=function(){return this.rpc.request("pss_getPublicKey")},e.sendAsym=function(t,e,r){return this.rpc.request("pss_sendAsym",[t,e,yt(r).value])},e.sendSym=function(t,e,r){return this.rpc.request("pss_sendSym",[t,e,yt(r).value])},e.sendRaw=function(t,e,r){return this.rpc.request("pss_sendRaw",[t,e,yt(r).value])},e.setPeerPublicKey=function(t,e,r){return this.rpc.request("pss_setPeerPublicKey",[t,e,r])},e.setSymmetricKey=function(t,e,r,n){return void 0===n&&(n=!1),this.rpc.request("pss_setSymmetricKey",[t,e,r,n])},e.stringToTopic=function(t){return this.rpc.request("pss_stringToTopic",[t])},e.subscribeTopic=function(t,e){return void 0===e&&(e=!1),this.rpc.request("pss_subscribe",["receive",t,e,!1])},e.createSubscription=function(n){var t=this;return Ut.create(function(r){return t.rpc.subscribe({next:function(t){if("pss_subscription"===t.method&&null!=t.params&&t.params.subscription===n){var e=t.params.result;if(null!=e)try{r.next({key:e.Key&&e.Key.length?e.Key:void 0,msg:yt(e.Msg)})}catch(t){console.warn("Error handling message",e,t)}}},error:function(t){r.error(t)},complete:function(){r.complete()}})})},e.createTopicSubscription=function(t,e){var r=this;return this.subscribeTopic(t,e).then(function(t){return r.createSubscription(t)})},t}();var gr,mr,_r,Er=function(){function t(t){void 0===t&&(t={}),u(this,"rpcInstance",void 0),this.rpcInstance=t.rpc}return t.prototype.disconnect=function(){null!=this.rpcInstance&&"function"==typeof this.rpcInstance.disconnect&&this.rpcInstance.disconnect()},i(t,[{key:"rpc",get:function(){if(null==this.rpcInstance)throw new Error("Could not access RPC: missing in configuration provided to client");return this.rpcInstance}}]),t}(),xr=self.crypto||self.msCrypto,Sr=function(){function t(t){void 0===t&&(t=!1),u(this,"canSubscribe",void 0),this.canSubscribe=t}return t.prototype.createID=function(){return function(t){t=t||21;for(var e="",r=xr.getRandomValues(new Uint8Array(t));0<t--;)e+="Uint8ArdomValuesObj012345679BCDEFGHIJKLMNPQRSTWXYZ_cfghkpqvwxyz-"[63&r[t]];return e}()},t}();(_r=mr=mr||{})[_r.PARSE_ERROR=-32700]="PARSE_ERROR",_r[_r.INVALID_REQUEST=-32600]="INVALID_REQUEST",_r[_r.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",_r[_r.INVALID_PARAMS=-32602]="INVALID_PARAMS",_r[_r.INTERNAL_ERROR=-32603]="INTERNAL_ERROR";var Tr=((gr={})[mr.PARSE_ERROR]="Parse error",gr[mr.INVALID_REQUEST]="Invalid request",gr[mr.METHOD_NOT_FOUND]="Method not found",gr[mr.INVALID_PARAMS]="Invalid params",gr[mr.INTERNAL_ERROR]="Internal error",gr);var Ar=function(i){function e(t,e,r){var n;return u(o(n=i.call(this)||this),"code",void 0),u(o(n),"data",void 0),u(o(n),"message",void 0),n.code=t,n.data=r,n.message=e||function(t){return Tr[t]||(function(t){return t<=-32e3&&-32099<=t}(t)?"Server error":"Application error")}(t),n}return s(e,i),e.fromObject=function(t){return new e(t.code,t.message,t.data)},e.prototype.toObject=function(){return{code:this.code,data:this.data,message:this.message}},e}(ft(Error));function Rr(e){var r=Tr[e];return function(t){return new Ar(e,r,t)}}Rr(mr.PARSE_ERROR),Rr(mr.INVALID_REQUEST),Rr(mr.METHOD_NOT_FOUND),Rr(mr.INVALID_PARAMS),Rr(mr.INTERNAL_ERROR);var Ir=function(r){function t(t){var e;return u(o(e=r.call(this,!1)||this),"fetch",void 0),e.fetch=t,e}return s(t,r),t.prototype.request=function(t,e){return this.fetch({id:this.createID(),jsonrpc:"2.0",method:t,params:e}).then(function(t){if(t.error)throw Ar.fromObject(t.error);return t.result})},t}(Sr),Or={Accept:"application/json","Content-Type":"application/json"},Pr="POST",kr=function(n){function t(t,e){var r;return u(o(r=n.call(this,e)||this),"status",void 0),r.status=t,r}return s(t,n),t}(ft(Error));function Nr(t){if(t.ok)return t;throw new kr(t.status,t.statusText)}function Br(t){return new Ir(function(i){return function(){var e=a(f.mark(function t(e){var r,n;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={body:JSON.stringify(e),headers:Or,method:Pr},t.t0=Nr,t.next=4,fetch(i,r);case 4:return t.t1=t.sent,n=(0,t.t0)(t.t1),t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()}(t))}var Ur=function(r){function t(t){var e;return u(o(e=r.call(this,!0)||this),"_observers",void 0),u(o(e),"_subscribers",void 0),u(o(e),"_subscription",void 0),u(o(e),"_transport",void 0),e._observers=new Map,e._subscribers=new Set,e._transport=t,e.connect(),e}s(t,r);var e=t.prototype;return e.connect=function(){var r,n=this;if(!this.connected&&(this._subscription=this._transport.subscribe({next:function(e){if(null==e.id)n._subscribers.forEach(function(t){t.next(e)});else{var t=n._observers.get(String(e.id));if(null!=t)if(null!=e.error){var r=Ar.fromObject(e.error);t.error(r),null!=e.id&&n._observers.delete(String(e.id))}else t.next(e.result);else console.warn("Missing observer for message ID:",e.id)}},error:function(t){var e;e=t instanceof Error?t:new Error("Connection failed"),r=e,n._observers.forEach(function(t){t.error(e)}),n._observers.clear(),n._subscribers.forEach(function(t){t.error(e)}),n._subscribers.clear()},complete:function(){n._observers.forEach(function(t){t.complete()}),n._observers.clear(),n._subscribers.forEach(function(t){t.complete()}),n._subscribers.clear()}}),null!=r))throw r},e.disconnect=function(){this._transport.complete()},e.observe=function(n,i){var o=this;return Ut.create(function(t){var e=o.createID(),r={jsonrpc:"2.0",method:n,id:e,params:i};return o._observers.set(e,new Pt(t)),o._transport.next(r),function(){o._observers.delete(e)}})},e.request=function(t,i){var o=this;return new Promise(function(e,r){if(o.connected)var n=o.observe(t,i).subscribe(function(t){n.unsubscribe(),e(t)},function(t){n.unsubscribe(),r(t)},function(){n.unsubscribe()});else r(new Error("Not connected"))})},e.notify=function(t,e){this._transport.next({jsonrpc:"2.0",method:t,params:e})},e.subscribe=function(){var t=this;if(!this.connected)throw new Error("Not connected");for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=at(Pt,r);return this._subscribers.add(i),function(){t._subscribers.delete(i)}},i(t,[{key:"connected",get:function(){return null!=this._subscription&&!this._subscription.closed}}]),t}(Sr),Cr={url:"",deserializer:function(t){return JSON.parse(t.data)},serializer:function(t){return JSON.stringify(t)}},Lr=function(o){function r(t,e){var r=o.call(this)||this;if(t instanceof Ut)r.destination=e,r.source=t;else{var n=r._config=wt({},Cr);if(r._output=new Dt,"string"==typeof t)n.url=t;else for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);if(!n.WebSocketCtor&&WebSocket)n.WebSocketCtor=WebSocket;else if(!n.WebSocketCtor)throw new Error("no WebSocket constructor can be found");r.destination=new re}return r}return bt(r,o),r.prototype.lift=function(t){var e=new r(this._config,this.destination);return e.operator=t,e.source=this,e},r.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new re),this._output=new Dt},r.prototype.multiplex=function(r,n,i){var o=this;return new Ut(function(e){try{o.next(r())}catch(t){e.error(t)}var t=o.subscribe(function(t){try{i(t)&&e.next(t)}catch(t){e.error(t)}},function(t){return e.error(t)},function(){return e.complete()});return function(){try{o.next(n())}catch(t){e.error(t)}t.unsubscribe()}})},r.prototype._connectSocket=function(){var n=this,t=this._config,e=t.WebSocketCtor,r=t.protocol,i=t.url,o=t.binaryType,s=this._output,u=null;try{u=r?new e(i,r):new e(i),this._socket=u,o&&(this._socket.binaryType=o)}catch(t){return void s.error(t)}var c=new Rt(function(){n._socket=null,u&&1===u.readyState&&u.close()});u.onopen=function(t){if(!n._socket)return u.close(),void n._resetState();var e=n._config.openObserver;e&&e.next(t);var r=n.destination;n.destination=Pt.create(function(t){if(1===u.readyState)try{var e=n._config.serializer;u.send(e(t))}catch(t){n.destination.error(t)}},function(t){var e=n._config.closingObserver;e&&e.next(void 0),t&&t.code?u.close(t.code,t.reason):s.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),n._resetState()},function(){var t=n._config.closingObserver;t&&t.next(void 0),u.close(),n._resetState()}),r&&r instanceof re&&c.add(r.subscribe(n.destination))},u.onerror=function(t){n._resetState(),s.error(t)},u.onclose=function(t){n._resetState();var e=n._config.closeObserver;e&&e.next(t),t.wasClean?s.complete():s.error(t)},u.onmessage=function(t){try{var e=n._config.deserializer;s.next(e(t))}catch(t){s.error(t)}}},r.prototype._subscribe=function(t){var e=this,r=this.source;return r?r.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(function(){var t=e._socket;0===e._output.observers.length&&(t&&1===t.readyState&&t.close(),e._resetState())}),t)},r.prototype.unsubscribe=function(){var t=this._socket;t&&1===t.readyState&&t.close(),this._resetState(),o.prototype.unsubscribe.call(this)},r}(Mt);function jr(t){return new Ur(function(t){return new Lr({url:t})}(t))}var zr=/^https?:\/\//i,Dr=/^wss?:\/\//i;function Mr(t){if(zr.test(t))return Br(t);if(Dr.test(t))return jr(t);throw new Error("Invalid endpoint provided: expecting HTTP or WebSocket URL")}var Fr,Yr=(Fr=Mr,function(t,e){return t instanceof e?t:"string"==typeof t?new e(Fr(t)):void 0}),Vr=function(r){function t(t){var e;return u(o(e=r.call(this,t)||this),"bzzInstance",void 0),u(o(e),"pssInstance",void 0),null==t.rpc&&null!=t.ws&&(e.rpcInstance=jr(t.ws)),null!=t.bzz?t.bzz instanceof br?e.bzzInstance=t.bzz:e.bzzInstance=new br(t.bzz):"string"==typeof t.http&&(e.bzzInstance=new br({url:t.http})),e.pssInstance=Yr(t.pss,wr),e}return s(t,r),i(t,[{key:"bzz",get:function(){if(null==this.bzzInstance)throw new Error("Missing Bzz instance or HTTP URL");return this.bzzInstance}},{key:"pss",get:function(){return null==this.pssInstance&&(this.pssInstance=new wr(this.rpc)),this.pssInstance}}]),t}(Er);t.Bzz=br,t.Hex=dt,t.Pss=wr,t.SwarmClient=Vr,t.createHex=yt,t.createRPC=Mr,Object.defineProperty(t,"__esModule",{value:!0})});